// Generated by CoffeeScript 2.5.1
(function() {
  var CompositeDisposable, Disposable, DisposableEvents, EventsDelegation, Mixin, NO_SELECTOR, eachPair;

  Mixin = require('mixto');

  DisposableEvents = require('./disposable-events');

  ({Disposable, CompositeDisposable} = require('atom'));

  eachPair = function(object, callback) {
    var k, results, v;
    results = [];
    for (k in object) {
      v = object[k];
      results.push(callback(k, v));
    }
    return results;
  };

  NO_SELECTOR = '__NONE__';

  module.exports = EventsDelegation = (function() {
    class EventsDelegation extends Mixin {
      subscribeTo(object, selector, events, options) {
        var disposablesForObject, eventsForObject;
        if (!(object instanceof HTMLElement)) {
          [object, selector, events, options] = [this, object, selector, events];
        }
        if (typeof selector === 'object') {
          [events, selector, options] = [selector, NO_SELECTOR, events];
        }
        if (this.eventsMap == null) {
          this.eventsMap = new WeakMap();
        }
        if (this.disposablesMap == null) {
          this.disposablesMap = new WeakMap();
        }
        if (this.eventsMap.get(object) == null) {
          this.eventsMap.set(object, {});
        }
        if (this.disposablesMap.get(object) == null) {
          this.disposablesMap.set(object, {});
        }
        eventsForObject = this.eventsMap.get(object);
        disposablesForObject = this.disposablesMap.get(object);
        eachPair(events, (event, callback) => {
          if (eventsForObject[event] == null) {
            eventsForObject[event] = {};
            disposablesForObject[event] = this.createEventListener(object, event, options);
          }
          return eventsForObject[event][selector] = callback;
        });
        return new Disposable(() => {
          return this.unsubscribeFrom(object, selector, events);
        });
      }

      unsubscribeFrom(object, selector, events) {
        var disposablesForObject, event, eventsForObject;
        if (!(object instanceof HTMLElement)) {
          [object, selector, events] = [this, object, selector];
        }
        if (typeof selector === 'object') {
          [events, selector] = [selector, NO_SELECTOR];
        }
        if (!(eventsForObject = this.eventsMap.get(object))) {
          return;
        }
        for (event in events) {
          delete eventsForObject[event][selector];
          if (Object.keys(eventsForObject[event]).length === 0) {
            disposablesForObject = this.disposablesMap.get(object);
            disposablesForObject[event].dispose();
            delete disposablesForObject[event];
            delete eventsForObject[event];
          }
        }
        if (Object.keys(eventsForObject).length === 0) {
          this.eventsMap.delete(object);
          return this.disposablesMap.delete(object);
        }
      }

      createEventListener(object, event, options) {
        var listener;
        listener = (e) => {
          var eventsForObject, ref, target;
          if (!(eventsForObject = (ref = this.eventsMap.get(object)) != null ? ref[event] : void 0)) {
            return;
          }
          ({target} = e);
          this.decorateEvent(e);
          this.eachSelectorFromTarget(e, target, eventsForObject);
          if (!e.isPropagationStopped) {
            if (typeof eventsForObject[NO_SELECTOR] === "function") {
              eventsForObject[NO_SELECTOR](e);
            }
          }
          return true;
        };
        return this.addDisposableEventListener(object, event, listener, options);
      }

      eachSelectorFromTarget(event, target, eventsForObject) {
        return this.nodeAndItsAncestors(target, (node) => {
          if (event.isPropagationStopped) {
            return;
          }
          return this.eachSelector(eventsForObject, (selector, callback) => {
            var matched;
            matched = this.targetMatch(node, selector);
            if (event.isImmediatePropagationStopped || !matched) {
              return;
            }
            return callback(event);
          });
        });
      }

      eachSelector(eventsForObject, callback) {
        var i, key, keys, len;
        keys = Object.keys(eventsForObject);
        if (keys.indexOf(NO_SELECTOR) !== -1) {
          keys.splice(keys.indexOf(NO_SELECTOR), 1);
        }
        keys.sort(function(a, b) {
          return b.split(' ').length - a.split(' ').length;
        });
        for (i = 0, len = keys.length; i < len; i++) {
          key = keys[i];
          if (callback(key, eventsForObject[key])) {
            return true;
          }
        }
        return false;
      }

      targetMatch(target, selector) {
        var parent;
        if (target.matches(selector)) {
          return true;
        }
        parent = target.parentNode;
        while ((parent != null) && (parent.matches != null)) {
          if (parent.matches(selector)) {
            return true;
          }
          parent = parent.parentNode;
        }
        return false;
      }

      nodeAndItsAncestors(node, callback) {
        var parent, results;
        parent = node.parentNode;
        callback(node);
        results = [];
        while ((parent != null) && (parent.matches != null)) {
          callback(parent);
          results.push(parent = parent.parentNode);
        }
        return results;
      }

      decorateEvent(e) {
        var overriddenStop, overriddenStopImmediate;
        overriddenStop = Event.prototype.stopPropagation;
        e.stopPropagation = function() {
          this.isPropagationStopped = true;
          return overriddenStop.apply(this, arguments);
        };
        overriddenStopImmediate = Event.prototype.stopImmediatePropagation;
        return e.stopImmediatePropagation = function() {
          this.isImmediatePropagationStopped = true;
          return overriddenStopImmediate.apply(this, arguments);
        };
      }

    };

    DisposableEvents.includeInto(EventsDelegation);

    return EventsDelegation;

  }).call(this);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZlbnRzLWRlbGVnYXRpb24uanMiLCJzb3VyY2VSb290IjoiLi4vLi4iLCJzb3VyY2VzIjpbImxpYi9taXhpbnMvZXZlbnRzLWRlbGVnYXRpb24uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUFBLE1BQUEsbUJBQUEsRUFBQSxVQUFBLEVBQUEsZ0JBQUEsRUFBQSxnQkFBQSxFQUFBLEtBQUEsRUFBQSxXQUFBLEVBQUE7O0VBQUEsS0FBQSxHQUFRLE9BQUEsQ0FBUSxPQUFSOztFQUNSLGdCQUFBLEdBQW1CLE9BQUEsQ0FBUSxxQkFBUjs7RUFDbkIsQ0FBQSxDQUFDLFVBQUQsRUFBYSxtQkFBYixDQUFBLEdBQW9DLE9BQUEsQ0FBUSxNQUFSLENBQXBDOztFQUNBLFFBQUEsR0FBVyxRQUFBLENBQUMsTUFBRCxFQUFTLFFBQVQsQ0FBQTtBQUFxQixRQUFBLENBQUEsRUFBQSxPQUFBLEVBQUE7QUFBQztJQUFBLEtBQUEsV0FBQTs7bUJBQUEsUUFBQSxDQUFTLENBQVQsRUFBVyxDQUFYO0lBQUEsQ0FBQTs7RUFBdEI7O0VBRVgsV0FBQSxHQUFjOztFQUVkLE1BQU0sQ0FBQyxPQUFQLEdBQ007SUFBTixNQUFBLGlCQUFBLFFBQStCLE1BQS9CO01BR0UsV0FBYSxDQUFDLE1BQUQsRUFBUyxRQUFULEVBQW1CLE1BQW5CLEVBQTJCLE9BQTNCLENBQUE7QUFDZixZQUFBLG9CQUFBLEVBQUE7UUFBSSxNQUFPLE1BQUEsWUFBa0IsWUFBekI7VUFDRSxDQUFDLE1BQUQsRUFBUyxRQUFULEVBQW1CLE1BQW5CLEVBQTJCLE9BQTNCLENBQUEsR0FBc0MsQ0FBQyxJQUFELEVBQU8sTUFBUCxFQUFlLFFBQWYsRUFBeUIsTUFBekIsRUFEeEM7O1FBR0EsSUFBaUUsT0FBTyxRQUFQLEtBQW1CLFFBQXBGO1VBQUEsQ0FBQyxNQUFELEVBQVMsUUFBVCxFQUFtQixPQUFuQixDQUFBLEdBQThCLENBQUMsUUFBRCxFQUFXLFdBQVgsRUFBd0IsTUFBeEIsRUFBOUI7OztV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QSxTQUFFLENBQUE7ZUFDbEMsQ0FBQyxDQUFDLHdCQUFGLEdBQTZCLFFBQUEsQ0FBQSxDQUFBO1VBQzNCLElBQUMsQ0FBQSw2QkFBRCxHQUFpQztpQkFDakMsdUJBQXVCLENBQUMsS0FBeEIsQ0FBOEIsSUFBOUIsRUFBb0MsU0FBcEM7UUFGMkI7TUFQaEI7O0lBaEdqQjs7SUFDRSxnQkFBZ0IsQ0FBQyxXQUFqQixDQUE2QixnQkFBN0I7Ozs7O0FBVEYiLCJzb3VyY2VzQ29udGVudCI6WyJNaXhpbiA9IHJlcXVpcmUgJ21peHRvJ1xuRGlzcG9zYWJsZUV2ZW50cyA9IHJlcXVpcmUgJy4vZGlzcG9zYWJsZS1ldmVudHMnXG57RGlzcG9zYWJsZSwgQ29tcG9zaXRlRGlzcG9zYWJsZX0gPSByZXF1aXJlICdhdG9tJ1xuZWFjaFBhaXIgPSAob2JqZWN0LCBjYWxsYmFjaykgLT4gY2FsbGJhY2soayx2KSBmb3Igayx2IG9mIG9iamVjdFxuXG5OT19TRUxFQ1RPUiA9ICdfX05PTkVfXydcblxubW9kdWxlLmV4cG9ydHMgPVxuY2xhc3MgRXZlbnRzRGVsZWdhdGlvbiBleHRlbmRzIE1peGluXG4gIERpc3Bvc2FibGVFdmVudHMuaW5jbHVkZUludG8odGhpcylcblxuICBzdWJzY3JpYmVUbzogKG9iamVjdCwgc2VsZWN0b3IsIGV2ZW50cywgb3B0aW9ucykgLT5cbiAgICB1bmxlc3Mgb2JqZWN0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnRcbiAgICAgIFtvYmplY3QsIHNlbGVjdG9yLCBldmVudHMsIG9wdGlvbnNdID0gW3RoaXMsIG9iamVjdCwgc2VsZWN0b3IsIGV2ZW50c11cblxuICAgIFtldmVudHMsIHNlbGVjdG9yLCBvcHRpb25zXSA9IFtzZWxlY3RvciwgTk9fU0VMRUNUT1IsIGV2ZW50c10gaWYgdHlwZW9mIHNlbGVjdG9yIGlzICdvYmplY3QnXG5cbiAgICBAZXZlbnRzTWFwID89IG5ldyBXZWFrTWFwXG4gICAgQGRpc3Bvc2FibGVzTWFwID89IG5ldyBXZWFrTWFwXG4gICAgQGV2ZW50c01hcC5zZXQob2JqZWN0LCB7fSkgdW5sZXNzIEBldmVudHNNYXAuZ2V0KG9iamVjdCk/XG4gICAgQGRpc3Bvc2FibGVzTWFwLnNldChvYmplY3QsIHt9KSB1bmxlc3MgQGRpc3Bvc2FibGVzTWFwLmdldChvYmplY3QpP1xuXG4gICAgZXZlbnRzRm9yT2JqZWN0ID0gQGV2ZW50c01hcC5nZXQob2JqZWN0KVxuICAgIGRpc3Bvc2FibGVzRm9yT2JqZWN0ID0gQGRpc3Bvc2FibGVzTWFwLmdldChvYmplY3QpXG5cbiAgICBlYWNoUGFpciBldmVudHMsIChldmVudCwgY2FsbGJhY2spID0+XG4gICAgICB1bmxlc3MgZXZlbnRzRm9yT2JqZWN0W2V2ZW50XT9cbiAgICAgICAgZXZlbnRzRm9yT2JqZWN0W2V2ZW50XSA9IHt9XG4gICAgICAgIGRpc3Bvc2FibGVzRm9yT2JqZWN0W2V2ZW50XSA9IEBjcmVhdGVFdmVudExpc3RlbmVyKG9iamVjdCwgZXZlbnQsIG9wdGlvbnMpXG5cbiAgICAgIGV2ZW50c0Zvck9iamVjdFtldmVudF1bc2VsZWN0b3JdID0gY2FsbGJhY2tcblxuICAgIG5ldyBEaXNwb3NhYmxlID0+IEB1bnN1YnNjcmliZUZyb20gb2JqZWN0LCBzZWxlY3RvciwgZXZlbnRzXG5cbiAgdW5zdWJzY3JpYmVGcm9tOiAob2JqZWN0LCBzZWxlY3RvciwgZXZlbnRzKSAtPlxuICAgIHVubGVzcyBvYmplY3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudFxuICAgICAgW29iamVjdCwgc2VsZWN0b3IsIGV2ZW50c10gPSBbdGhpcywgb2JqZWN0LCBzZWxlY3Rvcl1cblxuICAgIFtldmVudHMsIHNlbGVjdG9yXSA9IFtzZWxlY3RvciwgTk9fU0VMRUNUT1JdIGlmIHR5cGVvZiBzZWxlY3RvciBpcyAnb2JqZWN0J1xuXG4gICAgcmV0dXJuIHVubGVzcyBldmVudHNGb3JPYmplY3QgPSBAZXZlbnRzTWFwLmdldChvYmplY3QpXG5cbiAgICBmb3IgZXZlbnQgb2YgZXZlbnRzXG4gICAgICBkZWxldGUgZXZlbnRzRm9yT2JqZWN0W2V2ZW50XVtzZWxlY3Rvcl1cblxuICAgICAgaWYgT2JqZWN0LmtleXMoZXZlbnRzRm9yT2JqZWN0W2V2ZW50XSkubGVuZ3RoIGlzIDBcbiAgICAgICAgZGlzcG9zYWJsZXNGb3JPYmplY3QgPSBAZGlzcG9zYWJsZXNNYXAuZ2V0KG9iamVjdClcbiAgICAgICAgZGlzcG9zYWJsZXNGb3JPYmplY3RbZXZlbnRdLmRpc3Bvc2UoKVxuICAgICAgICBkZWxldGUgZGlzcG9zYWJsZXNGb3JPYmplY3RbZXZlbnRdXG4gICAgICAgIGRlbGV0ZSBldmVudHNGb3JPYmplY3RbZXZlbnRdXG5cbiAgICBpZiBPYmplY3Qua2V5cyhldmVudHNGb3JPYmplY3QpLmxlbmd0aCBpcyAwXG4gICAgICBAZXZlbnRzTWFwLmRlbGV0ZShvYmplY3QpXG4gICAgICBAZGlzcG9zYWJsZXNNYXAuZGVsZXRlKG9iamVjdClcblxuICBjcmVhdGVFdmVudExpc3RlbmVyOiAob2JqZWN0LCBldmVudCwgb3B0aW9ucykgLT5cbiAgICBsaXN0ZW5lciA9IChlKSA9PlxuICAgICAgcmV0dXJuIHVubGVzcyBldmVudHNGb3JPYmplY3QgPSBAZXZlbnRzTWFwLmdldChvYmplY3QpP1tldmVudF1cblxuICAgICAge3RhcmdldH0gPSBlXG4gICAgICBAZGVjb3JhdGVFdmVudChlKVxuXG4gICAgICBAZWFjaFNlbGVjdG9yRnJvbVRhcmdldChlLCB0YXJnZXQsIGV2ZW50c0Zvck9iamVjdClcbiAgICAgIGV2ZW50c0Zvck9iamVjdFtOT19TRUxFQ1RPUl0/KGUpIHVubGVzcyBlLmlzUHJvcGFnYXRpb25TdG9wcGVkXG4gICAgICByZXR1cm4gdHJ1ZVxuXG4gICAgQGFkZERpc3Bvc2FibGVFdmVudExpc3RlbmVyIG9iamVjdCwgZXZlbnQsIGxpc3RlbmVyLCBvcHRpb25zXG5cbiAgZWFjaFNlbGVjdG9yRnJvbVRhcmdldDogKGV2ZW50LCB0YXJnZXQsIGV2ZW50c0Zvck9iamVjdCkgLT5cbiAgICBAbm9kZUFuZEl0c0FuY2VzdG9ycyB0YXJnZXQsIChub2RlKSA9PlxuICAgICAgcmV0dXJuIGlmIGV2ZW50LmlzUHJvcGFnYXRpb25TdG9wcGVkXG4gICAgICBAZWFjaFNlbGVjdG9yIGV2ZW50c0Zvck9iamVjdCwgKHNlbGVjdG9yLGNhbGxiYWNrKSA9PlxuICAgICAgICBtYXRjaGVkID0gQHRhcmdldE1hdGNoKG5vZGUsIHNlbGVjdG9yKVxuICAgICAgICByZXR1cm4gaWYgZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgb3Igbm90IG1hdGNoZWRcbiAgICAgICAgY2FsbGJhY2soZXZlbnQpXG5cbiAgZWFjaFNlbGVjdG9yOiAoZXZlbnRzRm9yT2JqZWN0LCBjYWxsYmFjaykgLT5cbiAgICBrZXlzID0gT2JqZWN0LmtleXMoZXZlbnRzRm9yT2JqZWN0KVxuICAgIGlmIGtleXMuaW5kZXhPZihOT19TRUxFQ1RPUikgaXNudCAtIDFcbiAgICAgIGtleXMuc3BsaWNlKGtleXMuaW5kZXhPZihOT19TRUxFQ1RPUiksIDEpXG4gICAga2V5cy5zb3J0IChhLGIpIC0+IGIuc3BsaXQoJyAnKS5sZW5ndGggLSBhLnNwbGl0KCcgJykubGVuZ3RoXG5cbiAgICBmb3Iga2V5IGluIGtleXNcbiAgICAgIHJldHVybiB0cnVlIGlmIGNhbGxiYWNrKGtleSwgZXZlbnRzRm9yT2JqZWN0W2tleV0pXG4gICAgcmV0dXJuIGZhbHNlXG5cbiAgdGFyZ2V0TWF0Y2g6ICh0YXJnZXQsIHNlbGVjdG9yKSAtPlxuICAgIHJldHVybiB0cnVlIGlmIHRhcmdldC5tYXRjaGVzKHNlbGVjdG9yKVxuXG4gICAgcGFyZW50ID0gdGFyZ2V0LnBhcmVudE5vZGVcbiAgICB3aGlsZSBwYXJlbnQ/IGFuZCBwYXJlbnQubWF0Y2hlcz9cbiAgICAgIHJldHVybiB0cnVlIGlmIHBhcmVudC5tYXRjaGVzKHNlbGVjdG9yKVxuICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGVcblxuICAgIGZhbHNlXG5cbiAgbm9kZUFuZEl0c0FuY2VzdG9yczogKG5vZGUsIGNhbGxiYWNrKSAtPlxuICAgIHBhcmVudCA9IG5vZGUucGFyZW50Tm9kZVxuXG4gICAgY2FsbGJhY2sobm9kZSlcbiAgICB3aGlsZSBwYXJlbnQ/IGFuZCBwYXJlbnQubWF0Y2hlcz9cbiAgICAgIGNhbGxiYWNrKHBhcmVudClcbiAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlXG5cbiAgZGVjb3JhdGVFdmVudDogKGUpIC0+XG4gICAgb3ZlcnJpZGRlblN0b3AgPSAgRXZlbnQ6OnN0b3BQcm9wYWdhdGlvblxuICAgIGUuc3RvcFByb3BhZ2F0aW9uID0gLT5cbiAgICAgIEBpc1Byb3BhZ2F0aW9uU3RvcHBlZCA9IHRydWVcbiAgICAgIG92ZXJyaWRkZW5TdG9wLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcblxuICAgIG92ZXJyaWRkZW5TdG9wSW1tZWRpYXRlID0gIEV2ZW50OjpzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb25cbiAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9IC0+XG4gICAgICBAaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlXG4gICAgICBvdmVycmlkZGVuU3RvcEltbWVkaWF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4iXX0=
//# sourceURL=/home/runner/work/atom-utils-plus/atom-utils-plus/lib/mixins/events-delegation.coffee